/*! corner.js - v0.2.0 - 2013-06-14 */function check_if_exist(){if(arguments.length>=2){var a=Array.prototype.pop.call(arguments),b=!0;return Array.prototype.forEach.call(arguments,function(a){(void 0===a||null===a)&&(b=!1)}),b||console.error(a),b}return!1}function check_if_valid(){if(arguments.length>=2){var a=Array.prototype.pop.call(arguments),b=!0;return Array.prototype.forEach.call(arguments,function(a){a===!1&&(b=!1)}),b||console.error(a),b}return!1}function set_node_content(a,b,c){c?a.innerHTML=b:a.insertAdjacentHTML("beforeend",b)}function smart_eval(content){var output;try{output=eval("({"+content+"})")}catch(exception){try{output=eval(content)}catch(exception){output=content}}return output}Array.prototype.indexOf=Array.prototype.indexOf||function(a){"use strict";if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!==d&&1/0!==d&&d!==-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1},Array.prototype.forEach=Array.prototype.forEach||function(a,b){for(var c=0,d=this.length;d>c;++c)a.call(b,this[c],c,this)},Array.prototype.filter=Array.prototype.filter||function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d},"undefined"!=typeof WeakMap&&navigator.userAgent.indexOf("Firefox/")<0?window.SideTable=WeakMap:function(){var a=Object.defineProperty,b=Object.hasOwnProperty,c=(new Date).getTime()%1e9;window.SideTable=function(){this.name="__st"+(1e9*Math.random()>>>0)+(c++ +"__")},window.SideTable.prototype={set:function(b,c){a(b,this.name,{value:c,writable:!0})},get:function(a){return b.call(a,this.name)?a[this.name]:void 0},"delete":function(a){this.set(a,void 0)}}}(),window.MutationObserver=window.MutationObserver||window.WebKitMutationObserver,window.MutationObserver||function(){function a(a){t.push(a),s||(s=!0,p(c))}function b(a){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(a)||a}function c(){s=!1;var a=t;t=[],a.sort(function(a,b){return a.uid_-b.uid_});var b=!1;a.forEach(function(a){var c=a.takeRecords();d(a),c.length&&(a.callback_(c,a),b=!0)}),b&&c()}function d(a){a.nodes_.forEach(function(b){var c=o.get(b);c&&c.forEach(function(b){b.observer===a&&b.removeTransientObservers()})})}function e(a,b){for(var c=a;c;c=c.parentNode){var d=o.get(c);if(d)for(var e=0;e<d.length;e++){var f=d[e],g=f.options;if(c===a||g.subtree){var h=b(g);h&&f.enqueue(h)}}}}function f(a){this.callback_=a,this.nodes_=[],this.records_=[],this.uid_=++u}function g(a,b){this.type=a,this.target=b,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function h(a){var b=new g(a.type,a.target);return b.addedNodes=a.addedNodes.slice(),b.removedNodes=a.removedNodes.slice(),b.previousSibling=a.previousSibling,b.nextSibling=a.nextSibling,b.attributeName=a.attributeName,b.attributeNamespace=a.attributeNamespace,b.oldValue=a.oldValue,b}function i(a,b){return v=new g(a,b)}function j(a){return w?w:(w=h(v),w.oldValue=a,w)}function k(){v=w=void 0}function l(a){return a===w||a===v}function m(a,b){return a===b?a:w&&l(a)?w:null}function n(a,b,c){this.observer=a,this.target=b,this.options=c,this.transientObservedNodes=[]}var o=new SideTable,p=window.SetImmediate||window.msSetImmediate;if(!p){var q=[],r=String(Math.random());window.addEventListener("message",function(a){if(a.data===r){var b=q;q=[],b.forEach(function(a){a()})}}),p=function(a){q.push(a),window.postMessage(r,"*")}}var s=!1,t=[],u=0;f.prototype={observe:function(a,c){if(a.jquery&&(a=a[0]),a=b(a),!c.childList&&!c.attributes&&!c.characterData||c.attributeOldValue&&!c.attributes||c.attributeFilter&&c.attributeFilter.length&&!c.attributes||c.characterDataOldValue&&!c.characterData)throw new SyntaxError;var d=o.get(a);d||o.set(a,d=[]);for(var e,f=0;f<d.length;f++)if(d[f].observer===this){e=d[f],e.removeListeners(),e.options=c;break}e||(e=new n(this,a,c),d.push(e),this.nodes_.push(a)),e.addListeners()},disconnect:function(){this.nodes_.forEach(function(a){for(var b=o.get(a),c=0;c<b.length;c++){var d=b[c];if(d.observer===this){d.removeListeners(),b.splice(c,1);break}}},this),this.records_=[]},takeRecords:function(){var a=this.records_;return this.records_=[],a}};var v,w;n.prototype={enqueue:function(b){var c=this.observer.records_,d=c.length;if(c.length>0){var e=c[d-1],f=m(e,b);if(f)return c[d-1]=f,void 0}else a(this.observer);c[d]=b},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(a){var b=this.options;b.attributes&&a.addEventListener("DOMAttrModified",this,!0),b.characterData&&a.addEventListener("DOMCharacterDataModified",this,!0),b.childList&&a.addEventListener("DOMNodeInserted",this,!0),(b.childList||b.subtree)&&a.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(a){var b=this.options;b.attributes&&a.removeEventListener("DOMAttrModified",this,!0),b.characterData&&a.removeEventListener("DOMCharacterDataModified",this,!0),b.childList&&a.removeEventListener("DOMNodeInserted",this,!0),(b.childList||b.subtree)&&a.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(a){if(a!==this.target){this.addListeners_(a),this.transientObservedNodes.push(a);var b=o.get(a);b||o.set(a,b=[]),b.push(this)}},removeTransientObservers:function(){var a=this.transientObservedNodes;this.transientObservedNodes=[],a.forEach(function(a){this.removeListeners_(a);for(var b=o.get(a),c=0;c<b.length;c++)if(b[c]===this){b.splice(c,1);break}},this)},handleEvent:function(a){switch(a.stopImmediatePropagation(),a.type){case"DOMAttrModified":var b=a.attrName,c=a.relatedNode.namespaceURI,d=a.target,f=new i("attributes",d);f.attributeName=b,f.attributeNamespace=c;var g=a.attrChange===MutationEvent.ADDITION?null:a.prevValue;e(d,function(a){return!a.attributes||a.attributeFilter&&a.attributeFilter.length&&-1===a.attributeFilter.indexOf(b)&&-1===a.attributeFilter.indexOf(c)?void 0:a.attributeOldValue?j(g):f});break;case"DOMCharacterDataModified":var d=a.target,f=i("characterData",d),g=a.prevValue;e(d,function(a){return a.characterData?a.characterDataOldValue?j(g):f:void 0});break;case"DOMNodeRemoved":this.addTransientObserver(a.target);case"DOMNodeInserted":var h,l,d=a.relatedNode,m=a.target;"DOMNodeInserted"===a.type?(h=[m],l=[]):(h=[],l=[m]);var n=m.previousSibling,o=m.nextSibling,f=i("childList",d);f.addedNodes=h,f.removedNodes=l,f.previousSibling=n,f.nextSibling=o,e(d,function(a){return a.childList?f:void 0})}k()}},window.MutationObserver=f}(),$ajax=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){4==d.readyState&&(200==d.status?c&&c.call(d,d.responseText):console.error(b+" is not reachable"))},d.open(a,b,!0),d.send()},$ajax.get=function(a,b){this("GET",a,b)},$ajax.post=function(a,b){this("POST",a,b)},window.directive=function(){function shoot_observer(){observer_function([{addedNodes:[document.body],removedNodes:[],target:document.body}]),observer.observe(document.body,{attributes:!0,childList:!0,subtree:!0})}function directive_processor(a,b){if(config.allow_after_DOMReady||"complete"!=document.readyState){if(check_if_valid("string"==typeof a,b instanceof Object||b instanceof Function,"incorrect directive call format")){if(a=a.toLowerCase(),!directives[a]||config.allow_override)return create_directive(a,b);console.error("trying to register already registered directive "+a)}}else console.error("trying to register directive "+a+" after DOM loaded; current config prohibits this action");return!1}function create_directive(a,b){b instanceof Function&&(b={load:b});for(var c in common_directive)b[c]=b[c]||b[c];return b.name=a,b.aliases=[a],config.prefixes.forEach(function(c){b.aliases.push(c+"-"+a)}),directives[a]=b,b}function observer_function(a){a.forEach(function(a){switch(a.type){case"attributes":node_altered(a.target,a);break;default:a.addedNodes.forEach(function(a){apply_directives_in_subtree("load",a)}),a.removedNodes.forEach(function(a){apply_directives_in_subtree("unload",a)})}})}function apply_directives_in_subtree(a,b){switch(b.children&&b.children.forEach&&b.children.forEach(function(b){apply_directives_in_subtree(a,b)}),a){case"load":node_loaded(b);break;case"unload":node_unloaded(b)}}function node_loaded(a){a.directives=detect_directives_for_node(a),generate_attribute_directive_aliases(a);for(var b in a.directives)generate_directive_scope(a,a.directives[b].directive);for(var b in a.directives){var c=a.directives[b],d=c.directive,e=function(b,c){return function(d){var e=b.attribute?smart_eval(b.attribute.value):void 0;d&&set_node_content(a,d,c.replace),c.load.call(a[c.name],a,e)}}(c,d);d.template_url?$ajax.get(d.template_url,e):e(d.template)}}function node_unloaded(a){if(a.directives)for(var b in a.directives)directives[b].unload.call(a[b],a)}function node_altered(a,b){var c=a.directive_aliases[b.attributeName];if(c&&c.attribute){var d=a.attributes.getNamedItem(b.attributeName).value;c.attribute.value!==d&&(c.attribute.value=d,c.directive.alter.call(c,a,smart_eval(d)))}}function generate_attribute_directive_aliases(a){a.directive_aliases={};for(var b in a.directives)a.directives[b].attribute&&(a.directive_aliases[a.directives[b].attribute.name]=a.directives[b])}function generate_directive_scope(a,b){a[b.name]={directive:b,node:a}}function resolve_directives_in_classes(a){var b=[];return(a.classList||a.className)&&(a.classList=a.classList||a.className.split(" "),a.classList.forEach(function(a){a=a.toLowerCase();for(var c in directives){var d=directives[c];d.aliases.forEach(function(c){a==c&&b.push({directive:d,"class":a})})}})),b}function resolve_directives_in_attributes(node){var attribute_directives_list=[];return node.attributes&&node.attributes.forEach&&node.attributes.forEach(function(attribute){if(-1==config.ignored_attributes.indexOf(attribute.name)){var attribute_name=attribute.name.toLowerCase();for(var directive_name in directives){var directive=directives[directive_name];directive.aliases.forEach(function(alias){if(attribute_name==alias){var attribute_value=attribute.textContent,parsed_value;if(attribute_value)try{parsed_value=eval("({"+attribute_value+"})")}catch(exception){try{parsed_value=eval(attribute_value)}catch(exception){parsed_value=attribute_value}}attribute_directives_list.push({directive:directive,attribute:{name:attribute_name,value:attribute_value,parsed_value:parsed_value}})}})}}}),attribute_directives_list}function detect_directives_for_node(a){var b={};return resolve_directives_in_classes(a).forEach(function(a){b[a.directive.name]=a}),resolve_directives_in_attributes(a).forEach(function(a){b[a.directive.name]=a}),b}check_if_exist(window.XMLHttpRequest,"XMLHttpRequest not found"),check_if_exist(window.MutationObserver,"MutationObserver (or polyfill) not found"),check_if_exist(Array.prototype.indexOf,Array.prototype.forEach,Array.prototype.filter,"MutationObserver (or polyfill) not found"),NodeList.prototype.forEach=NodeList.prototype.forEach||Array.prototype.forEach,HTMLCollection.prototype.forEach=HTMLCollection.prototype.forEach||Array.prototype.forEach,DOMTokenList.prototype.forEach=DOMTokenList.prototype.forEach||Array.prototype.forEach,NamedNodeMap.prototype.forEach=NamedNodeMap.prototype.forEach||Array.prototype.forEach;var config=directive_processor.config={prefixes:["data","directive"],allow_override:!1,allow_after_DOMReady:!0,ignored_attributes:["class","href"]},common_directive={load:function(){},ready:function(){},alter:function(){},unload:function(){},template:void 0,template_url:void 0,replace:!1},directives=directive_processor.directives={},observer=new MutationObserver(observer_function);return"complete"==document.readyState?shoot_observer():document.addEventListener("DOMContentLoaded",shoot_observer,!1),directive_processor}();