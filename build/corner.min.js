/*! corner.js - v0.2.2 - 2013-07-22 */!function(){var a=(new Date).getTime()%1e9;window.SideTable=function(){this.name="__st"+(1e9*Math.random()>>>0)+(a++ +"__")},window.SideTable.prototype={set:function(a,b){Object.defineProperty(a,this.name,{value:b,writable:!0})},get:function(a){return Object.hasOwnProperty.call(a,this.name)?a[this.name]:void 0},"delete":function(a){this.set(a,void 0)}}}(),window.MutationObserver=window.MutationObserver||window.WebKitMutationObserver||function(){function a(a){t.push(a),s||(s=!0,p(c))}function b(a){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(a)||a}function c(){s=!1;var a=t;t=[],a.sort(function(a,b){return a.uid_-b.uid_});var b=!1;a.forEach(function(a){var c=a.takeRecords();d(a),c.length&&(a.callback_(c,a),b=!0)}),b&&c()}function d(a){a.nodes_.forEach(function(b){var c=o.get(b);c&&c.forEach(function(b){b.observer===a&&b.removeTransientObservers()})})}function e(a,b){for(var c=a;c;c=c.parentNode){var d=o.get(c);if(d)for(var e=0;e<d.length;e++){var f=d[e],g=f.options;if(c===a||g.subtree){var h=b(g);h&&f.enqueue(h)}}}}function f(a){this.callback_=a,this.nodes_=[],this.records_=[],this.uid_=++u}function g(a,b){this.type=a,this.target=b,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function h(a){var b=new g(a.type,a.target);return b.addedNodes=a.addedNodes.slice(),b.removedNodes=a.removedNodes.slice(),b.previousSibling=a.previousSibling,b.nextSibling=a.nextSibling,b.attributeName=a.attributeName,b.attributeNamespace=a.attributeNamespace,b.oldValue=a.oldValue,b}function i(a,b){return v=new g(a,b)}function j(a){return w?w:(w=h(v),w.oldValue=a,w)}function k(){v=w=void 0}function l(a){return a===w||a===v}function m(a,b){return a===b?a:w&&l(a)?w:null}function n(a,b,c){this.observer=a,this.target=b,this.options=c,this.transientObservedNodes=[]}var o=new SideTable,p=window.SetImmediate||window.msSetImmediate;if(!p){var q=[],r=String(Math.random());window.addEventListener("message",function(a){if(a.data===r){var b=q;q=[],b.forEach(function(a){a()})}}),p=function(a){q.push(a),window.postMessage(r,"*")}}var s=!1,t=[],u=0;f.prototype={observe:function(a,c){if(a.jquery&&(a=a[0]),a=b(a),!c.childList&&!c.attributes&&!c.characterData||c.attributeOldValue&&!c.attributes||c.attributeFilter&&c.attributeFilter.length&&!c.attributes||c.characterDataOldValue&&!c.characterData)throw new SyntaxError;var d=o.get(a);d||o.set(a,d=[]);for(var e,f=0;f<d.length;f++)if(d[f].observer===this){e=d[f],e.removeListeners(),e.options=c;break}e||(e=new n(this,a,c),d.push(e),this.nodes_.push(a)),e.addListeners()},disconnect:function(){this.nodes_.forEach(function(a){for(var b=o.get(a),c=0;c<b.length;c++){var d=b[c];if(d.observer===this){d.removeListeners(),b.splice(c,1);break}}},this),this.records_=[]},takeRecords:function(){var a=this.records_;return this.records_=[],a}};var v,w;return n.prototype={enqueue:function(b){var c=this.observer.records_,d=c.length;if(c.length>0){var e=c[d-1],f=m(e,b);if(f)return c[d-1]=f,void 0}else a(this.observer);c[d]=b},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(a){var b=this.options;b.attributes&&a.addEventListener("DOMAttrModified",this,!0),b.characterData&&a.addEventListener("DOMCharacterDataModified",this,!0),b.childList&&a.addEventListener("DOMNodeInserted",this,!0),(b.childList||b.subtree)&&a.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(a){var b=this.options;b.attributes&&a.removeEventListener("DOMAttrModified",this,!0),b.characterData&&a.removeEventListener("DOMCharacterDataModified",this,!0),b.childList&&a.removeEventListener("DOMNodeInserted",this,!0),(b.childList||b.subtree)&&a.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(a){if(a!==this.target){this.addListeners_(a),this.transientObservedNodes.push(a);var b=o.get(a);b||o.set(a,b=[]),b.push(this)}},removeTransientObservers:function(){var a=this.transientObservedNodes;this.transientObservedNodes=[],a.forEach(function(a){this.removeListeners_(a);for(var b=o.get(a),c=0;c<b.length;c++)if(b[c]===this){b.splice(c,1);break}},this)},handleEvent:function(a){switch(a.stopImmediatePropagation(),a.type){case"DOMAttrModified":var b=a.attrName,c=a.relatedNode.namespaceURI,d=a.target,f=new i("attributes",d);f.attributeName=b,f.attributeNamespace=c;var g=a.attrChange===MutationEvent.ADDITION?null:a.prevValue;e(d,function(a){return!a.attributes||a.attributeFilter&&a.attributeFilter.length&&-1===a.attributeFilter.indexOf(b)&&-1===a.attributeFilter.indexOf(c)?void 0:a.attributeOldValue?j(g):f});break;case"DOMCharacterDataModified":var d=a.target,f=i("characterData",d),g=a.prevValue;e(d,function(a){return a.characterData?a.characterDataOldValue?j(g):f:void 0});break;case"DOMNodeRemoved":this.addTransientObserver(a.target);case"DOMNodeInserted":var h,l,d=a.relatedNode,m=a.target;"DOMNodeInserted"===a.type?(h=[m],l=[]):(h=[],l=[m]);var n=m.previousSibling,o=m.nextSibling,f=i("childList",d);f.addedNodes=h,f.removedNodes=l,f.previousSibling=n,f.nextSibling=o,e(d,function(a){return a.childList?f:void 0})}k()}},f}(),function(){var __hasProp={}.hasOwnProperty;Array.prototype.flatten=function(){var a,b,c,d;for(a=[],c=0,d=this.length;d>c;c++)b=this[c],null!=b&&(a=a.concat(b.flatten?b.flatten():b));return a},Object.prototype["do"]=function(a){return a(this)},window.directive=function(){var apply_directives_in_subtree,config,create_directive,directive_processor,directives,node_altered,node_loaded,node_unloaded,observer,observer_function,put_in_queue,resolve_directives_in_attributes,resolve_directives_in_classes,resolve_directives_in_tag,shoot_observer,smart_eval;return smart_eval=function(content){var output;output=content;try{output=eval(content)}catch(_error){}try{output=eval("({"+content+"})")}catch(_error){}return output},put_in_queue=function(a){return setTimeout(a,0)},apply_directives_in_subtree=function(a,b){var c,d,e,f;if(b.children)for(f=b.children,d=0,e=f.length;e>d;d++)c=f[d],apply_directives_in_subtree(a,c);switch(a){case"load":return node_loaded(b);case"unload":return node_unloaded(b)}},resolve_directives_in_classes=function(a){var b,c,d,e,f,g,h,i;for(h=a.classList||a.className&&a.className.split(" ")||[],i=[],f=0,g=h.length;g>f;f++)b=h[f],i.push(function(){var a;a=[];for(d in directives)__hasProp.call(directives,d)&&(c=directives[d],a.push(function(){var a,f,g,h;for(g=config.prefixes,h=[],a=0,f=g.length;f>a;a++)e=g[a],b.toLowerCase()===e+d&&h.push({directive:c});return h}()));return a}());return i},resolve_directives_in_attributes=function(a){var b,c,d,e,f,g,h,i;for(h=a.attributes||[],i=[],f=0,g=h.length;g>f;f++)b=h[f],-1===config.ignored_attributes.indexOf(b.name)&&i.push(function(){var a;a=[];for(d in directives)__hasProp.call(directives,d)&&(c=directives[d],a.push(function(){var a,f,g,h;for(g=config.prefixes,h=[],a=0,f=g.length;f>a;a++)e=g[a],b.name.toLowerCase()===e+d&&h.push({directive:c,attribute:{name:b.name.toLowerCase(),value:b.value}});return h}()));return a}());return i},resolve_directives_in_tag=function(a){var b,c,d,e;if(null==a.tagName)return[];e=[];for(c in directives)__hasProp.call(directives,c)&&(b=directives[c],e.push(function(){var e,f,g,h;for(g=config.prefixes,h=[],e=0,f=g.length;f>e;e++)d=g[e],a.tagName.toLowerCase()===d+c&&h.push({directive:b,attribute:{value:a.attributes["do"](function(a){var b,c,d,e;for(b={},d=0,e=a.length;e>d;d++)c=a[d],b[c.name]=smart_eval(c.value);return b})}});return h}()));return e},node_loaded=function(a){var b,c,d,e,f,g,h,i,j,k;if(!a.directives){for(a.directives={},a.directive_aliases={},f=[].concat(resolve_directives_in_classes(a)).concat(resolve_directives_in_attributes(a)).concat(resolve_directives_in_tag(a)).flatten(),h=0,i=f.length;i>h;h++)e=f[h],a.directives[e.directive.name]=e,e.attribute&&(a.directive_aliases[e.attribute.name]=e);j=a.directives,k=[];for(d in j)g=j[d],null!=g&&null==a[d]&&(a[d]={directive:g,node:a},c=g.directive,c.load?(b=g.attribute?smart_eval(g.attribute.value):void 0,k.push(put_in_queue(c.load.bind(a[c.name],a,b)))):k.push(void 0));return k}},node_unloaded=function(a){var b,c,d,e;if(a.directives){d=a.directives,e=[];for(b in d)c=d[b],null!=c&&null!=directives[b].unload&&e.push(put_in_queue(directives[b].unload.bind(a[b],a,c.attribute?smart_eval(c.attribute.value):void 0)));return e}},node_altered=function(a,b){var c,d;return a.directive_aliases&&(d=a.directive_aliases[b.attributeName],d&&d.attribute&&d.directive.alter&&(c=a.attributes.getNamedItem(b.attributeName).value,d.attribute.value!==c))?(d.attribute.value=c,put_in_queue(d.directive.alter.bind(d,a,smart_eval(c)))):void 0},create_directive=function(a,b){return b instanceof Function&&(b={load:b}),b.name=a.toLowerCase(),directives[b.name]=b,"complete"===document.readyState?Array.prototype.forEach.call(document.querySelectorAll(config.prefixes.map(function(a){return".alias, [alias]".replace(/alias/g,a+b.name)}).join(", ")),node_loaded):void 0},observer_function=function(a){return Array.prototype.forEach.call(a,function(a){var b,c,d,e,f,g,h,i,j;switch(a.type){case"attributes":return node_altered(a.target,a);default:for(h=a.addedNodes,d=0,f=h.length;f>d;d++)b=h[d],apply_directives_in_subtree("load",b);for(i=a.removedNodes,j=[],e=0,g=i.length;g>e;e++)c=i[e],j.push(apply_directives_in_subtree("unload",c));return j}})},shoot_observer=function(){return observer_function([{addedNodes:[document.body],removedNodes:[],target:document.body}]),observer.observe(document.body,{attributes:!0,childList:!0,subtree:!0})},config={prefixes:["data-","directive-",""],allow_after_DOMReady:!0,ignored_attributes:["class","href"]},directives={},observer=new MutationObserver(observer_function),directive_processor=function(a,b){if(a.constructor!==String||!(b instanceof Object||b instanceof Function))throw new TypeError("incorrect directive format");if(!config.allow_after_DOMReady&&"complete"===document.readyState)throw"trying to register directive "+a+" after DOM loaded; current config prohibits this action";if(directives[a.toLowerCase()])throw"trying to register already registered directive "+a;return create_directive(a,b)},Object.defineProperty(directive_processor,"config",{get:function(){return config}}),Object.defineProperty(directive_processor,"directives",{get:function(){return directives}}),"complete"===document.readyState?shoot_observer():document.addEventListener("DOMContentLoaded",shoot_observer,!1),directive_processor}()}.call(this);